<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><title>【译】Javascript 基准测试 | bubkoo</title><meta name="author" content="bubkoo"><meta name="description" content="原文发表在 Performance Calendar 上，作为其 2010 年系列文章的一部分。在上一篇翻译的文章中，作者推荐了这篇文章，译者阅读之后觉得有一定的价值，而且网络上没有这篇文章的中文翻译，权当学习就在此翻译成了中文，水平有限，如果有表达不恰当或者表达有误的地方，请直接在评论中指出。
原文链接：Bulletproof JavaScript benchmarks，下面开始翻译正文。
编写 JavaScript 基准测试并不是想象的那么容易，撇开潜在的跨浏览器兼容问题不说，还将面临很多陷阱（甚至诡雷）。
这也是我创建 jsPerf 的一部分原因，jsPerf 提供了一个非常简单的 Web 接口，您可以非常轻松地创建和分享不同代码片段的性能测试用例。您不需要考虑其他问题，只需要输入你想做基准测试的代码，jsPerf 就会为您创建一个运行在不同的浏览器和设备上测试用例。
其实，jsPerf 最开始使用的是一个基于 JSLitmus 的基准测试库 - Benchmark.js。后来添加了很多新功能，最近，John-David Dalton 又从头开始完全重写了该代码，Benchmark.js 也变得越来越完善。
本文将阐明编写和运行 JavaScript 基准测试的各种陷阱。"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:title" content="【译】Javascript 基准测试"><meta property="og:site_name" content="bubkoo"><link href="/favicon.ico" rel="icon" type="image/x-ico"><link href="/atom.xml" rel="alternate" title="bubkoo" type="application/atom+xml"><link href="/css/style.css" rel="stylesheet" type="text/css" charset="utf-8"><link href="/fancybox/jquery.fancybox.css" rel="stylesheet" type="text/css" charset="utf-8"><script id="google_analytics">(function (window, document, src, ga) {

  window['GoogleAnalyticsObject'] = ga;

  if (!window[ga]) {
    window[ga] = function () {
      (window[ga].q = window[ga].q || []).push(arguments);
    };
  }

  window[ga].l = 1 * new Date();

  var thisTag = document.getElementById('google_analytics');
  var script  = document.createElement('script');

  script.async = true;
  script.src   = src;

  thisTag.parentNode.insertBefore(script, thisTag);

  setTimeout(function () {
    script.parentNode.removeChild(script);
    thisTag.parentNode.removeChild(thisTag);
  }, 100);

})(window, document, 'https://www.google-analytics.com/analytics.js', 'ga');

ga('create', 'UA-78428859-2', 'auto');
ga('send', 'pageview');</script><script id="baidu_tongji">var _hmt = _hmt || [];
(function () {
  var script  = document.createElement('script');
  var thisTag = document.getElementById('baidu_tongji');

  script.src = '//hm.baidu.com/hm.js?49a1665c33b011585a2a629fdbed5b61';

  thisTag.parentNode.insertBefore(script, thisTag);

  setTimeout(function () {
    script.parentNode.removeChild(script);
    thisTag.parentNode.removeChild(thisTag);
  }, 100);
})();</script><!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--><script>__start__ = window.performance && performance.timing ? performance.timing.navigationStart : Date.now();</script></head><body><header id="header" hoot="default" hoot-rate="1" class="inner"><div class="f-left"><a href="/" class="site-title">bubkoo</a></div><nav class="f-right"><ul class="site-nav"><li><a href="/">&lt;&gt;</a></li><li><a href="/archives">Archives</a></li><li><a href="https://github.com/bubkoo">Github</a></li></ul></nav></header><div id="container" class="inner"><div id="main"><article class="article post"><div class="article-wrap"><header class="article-header"><span class="article-header-icon icon-black"></span><h1 class="article-header-title">【译】Javascript 基准测试</h1><time datetime="2014-02-18T20:51:29.000Z" itemprop="datePublished" class="article-header-time"><span class="day">18</span><span class="month">2014年02月</span></time></header><section class="article-content"><p>原文发表在 <a href="http://calendar.perfplanet.com/" target="_blank" rel="external">Performance Calendar</a> 上，作为其 2010 年系列文章的一部分。在<a href="http://bubkoo.com/2014/02/13/writing-fast-memory-efficient-javascript/">上一篇</a>翻译的文章中，作者推荐了这篇文章，译者阅读之后觉得有一定的价值，而且网络上没有这篇文章的中文翻译，权当学习就在此翻译成了中文，水平有限，如果有表达不恰当或者表达有误的地方，请直接在评论中指出。</p>
<p>原文链接：<a href="http://calendar.perfplanet.com/2010/bulletproof-javascript-benchmarks/" target="_blank" rel="external">Bulletproof JavaScript benchmarks</a>，下面开始翻译正文。</p>
<p>编写 JavaScript 基准测试并不是想象的那么容易，撇开潜在的跨浏览器兼容问题不说，还将面临很多陷阱（甚至诡雷）。</p>
<p>这也是我创建 <a href="http://jsperf.com/" target="_blank" rel="external">jsPerf</a> 的一部分原因，jsPerf 提供了一个非常简单的 Web 接口，您可以非常轻松地创建和分享不同代码片段的性能测试用例。您不需要考虑其他问题，只需要输入你想做基准测试的代码，jsPerf 就会为您创建一个运行在不同的浏览器和设备上测试用例。</p>
<p>其实，jsPerf 最开始使用的是一个基于 <a href="https://github.com/broofa/jslitmus" target="_blank" rel="external">JSLitmus</a> 的基准测试库 - <a href="https://github.com/mathiasbynens/benchmark.js" target="_blank" rel="external">Benchmark.js</a><br>。后来添加了很多新功能，最近，<a href="http://allyoucanleet.com/" target="_blank" rel="external">John-David Dalton</a><br> 又从头开始完全重写了该代码，Benchmark.js 也变得越来越完善。</p>
<p>本文将阐明编写和运行 JavaScript 基准测试的各种陷阱。<br><a id="more"></a></p>
<h2><span id="基准测试的方式">基准测试的方式</span></h2><p>目前，有很多方法可以对 JavaScript 代码片段进行性能基准测试。最常见的模式如下：</p>
<h3><span id="方式-a">方式 A</span></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> totalTime,</div><div class="line">    start = <span class="keyword">new</span> <span class="built_in">Date</span>,</div><div class="line">    iterations = <span class="number">6</span>;</div><div class="line"><span class="keyword">while</span> (iterations--) &#123;</div><div class="line">  <span class="comment">// 您的 JavaScript 代码片段</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// totalTime → 代码片段的总共执行时间</span></div><div class="line"><span class="comment">// 代码片段循环了 6 次</span></div><div class="line">totalTime = <span class="keyword">new</span> <span class="built_in">Date</span> - start;</div></pre></td></tr></table></figure>
<p>将要测试的代码片段放在一个循环中，并使其执行预定义的次数（这里是 6 次），然后，用结束时间减去开始时间就可以得到整个代码的执行时间。方式 A 被 <a href="https://github.com/kamicane/slickspeed/" target="_blank" rel="external">SlickSpeed</a>、<a href="https://github.com/phiggins42/taskspeed" target="_blank" rel="external">Taskspeed</a>、<a href="http://www2.webkit.org/perf/sunspider/sunspider.html" target="_blank" rel="external">SunSpider</a> 和 <a href="http://krakenbenchmark.mozilla.org/" target="_blank" rel="external">Kraken</a> 这样一些流行的基准测试组件采纳。</p>
<h3><span id="方式-a-的问题">方式 A 的问题</span></h3><p>由于浏览器和设备变得越来越快，方式 A 的测试很大可能会得到 0ms，这使得测试结果不可用。</p>
<h3><span id="方式-b">方式 B</span></h3><p>另一种方法是计算在指定时间段内可以执行多少次操作，这种方式的优点是不需要您指定一个迭代次数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> hz,</div><div class="line">    period,</div><div class="line">    startTime = <span class="keyword">new</span> <span class="built_in">Date</span>,</div><div class="line">    runs = <span class="number">0</span>;</div><div class="line"><span class="keyword">do</span> &#123;</div><div class="line">  <span class="comment">// 您的代码片段</span></div><div class="line">  runs++;</div><div class="line">  totalTime = <span class="keyword">new</span> <span class="built_in">Date</span> - startTime;</div><div class="line">&#125; <span class="keyword">while</span> (totalTime &lt; <span class="number">1000</span>);</div><div class="line"></div><div class="line"><span class="comment">// 将毫秒转换成秒</span></div><div class="line">totalTime /= <span class="number">1000</span>;</div><div class="line"></div><div class="line"><span class="comment">// period → 执行每个操作需要的时间</span></div><div class="line">period = totalTime / runs;</div><div class="line"></div><div class="line"><span class="comment">// hz → 每秒可以执行多少个操作</span></div><div class="line">hz = <span class="number">1</span> / period;</div><div class="line"></div><div class="line"><span class="comment">// 可以简写为</span></div><div class="line"><span class="comment">// hz = (runs * 1000) / totalTime;</span></div></pre></td></tr></table></figure>
<p>这里的代码片段大约执行了 1 秒钟，方式 B 被使用在 <a href="http://dromaeo.com/" target="_blank" rel="external">Dromaeo</a> 和  <a href="http://code.google.com/apis/v8/benchmarks.html" target="_blank" rel="external">V8 基准测试组件</a>中。</p>
<h3><span id="方式-b-的问题">方式 B 的问题</span></h3><p>在进行这种基准测试时，由于垃圾回收机制、引擎优化和其他后台进程的影响，测试结果会有所不同。由于这种差异，就需要运行数次基准测试代码来取得平均结果。然而，在 V8 中每个基准测试只会运行 1 次，Dromaeo 也仅仅只会运行 5 次。我们可以通过运行更多次来减少误差幅度，方法之一是通过减少每次基准测试运行的时间，例如从 1000ms 减少到 50ms，这样在相同的时间内就可以运行更多次数的基准测试。</p>
<h3><span id="方式-c">方式 C</span></h3><p><a href="http://www.broofa.com/Tools/JSLitmus/" target="_blank" rel="external">JSLitmus</a> 是基于上面这两种方式来构建的，它使用方式 A 来将一个测试运行 n 次，同时使用方式 B 来动态增加 n 来保持测试运行，直到达到最小测试时间。</p>
<h3><span id="方式-c-的问题">方式 C 的问题</span></h3><p>JSLitmus 避免了方式 A 的问题，但仍有方式 B 的问题。为了提高结果的准确性，JSLitmus 通过获取三次空测试中最快的那个时间，然后将每次基准测试的时间减去这个最快时间，来校准测试结果。不幸的是，这种方法混淆了最终结果，因为“获取 3 个空测试中的最快时间”不是一个统计上有效的方法。虽然 JSLitmus 运行基准测试数次，并且从基准测试的平均结果中减去了校验平均值，还是增加了最终结果的误差幅度，也吞噬了增加准确性的希望。</p>
<h3><span id="方式-d">方式 D</span></h3><p>方式 A、B 和 C 的缺点可以通过编译函数和展开循环来避免。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  x == y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">while</span> (iterations--) &#123;</div><div class="line">  test();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ...would compile to →</span></div><div class="line"><span class="keyword">var</span> hz,</div><div class="line">    startTime = <span class="keyword">new</span> <span class="built_in">Date</span>;</div><div class="line"></div><div class="line">x == y;</div><div class="line">x == y;</div><div class="line">x == y;</div><div class="line">x == y;</div><div class="line">x == y;</div><div class="line"><span class="comment">// ...</span></div><div class="line"></div><div class="line">hz = (runs * <span class="number">1000</span>) / (<span class="keyword">new</span> <span class="built_in">Date</span> - startTime);</div></pre></td></tr></table></figure>
<h3><span id="方式-d-的问题">方式 D 的问题</span></h3><p>然而，这也有它的短板。编译函数会大大增加内存使用量和减慢您的CPU，当您重复运行测试几百万次时，基本上就等于创建了一个非常大的字符串和编译了一个庞大的函数。</p>
<p>使用展开循环的另一个警告是，<code>return</code> 语句可以使测试提前退出。花了很大成本去编译一个有数百万行代码的函数，然而这个函数在执行到第 3 行就返回了，这非常没有意义。有必要进行早期退出检测，如果有早期退出就回到使用 while 循环的模式，并在需要时通过循环校准。</p>
<h3><span id="提取函数体">提取函数体</span></h3><p>Benchmark.js 使用了稍微有些不同的方法，可以说它使用了前面四种方式中的最好的部分。因为内存问题，我们不展开循环，为了减少可能会使结果不准确的因素，并允许测试访问本地方法和变量，我们在每个测试中提取出函数体。例如，当测试这样的代码时：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>,</div><div class="line">    y = <span class="string">"1"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  x == y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">while</span> (iterations--) &#123;</div><div class="line">  test();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ...would compile to →</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>,</div><div class="line">    y = <span class="string">"1"</span>;</div><div class="line"><span class="keyword">while</span> (iterations--) &#123;</div><div class="line">  x == y;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后，Benchmark.js 使用了和 JSLitmus 类似的方法：将提取的函数体放在一个 while 循环中运行（方式 A），重复运作直到达到最小的运行次数（方式 B），并将整个过程重复数次，来得到有统计意义的结果。</p>
<h2><span id="需要考虑的问题">需要考虑的问题</span></h2><h3><span id="不准确的毫秒计时器">不准确的毫秒计时器</span></h3><p>在一些浏览器/操作系统中，由于<a href="http://www.microsoft.com/whdc/system/sysinternals/mm-timer.mspx#EQB" target="_blank" rel="external">各种各样</a>的<a href="http://alivebutsleepy.srnet.cz/unreliable-system-nanotime/" target="_blank" rel="external">因素</a>，计时器可能是不准确的。</p>
<p>例如：</p>
<blockquote>
<p>当 Windows XP 启动后，典型的默认时钟中断期是 10 毫秒，尽管在一些系统使用的是 15 毫秒。这意味着，每 10 毫秒，操作系统就接收来自系统定时器硬件中断通知。</p>
</blockquote>
<p>一些老的浏览器（IE，Firefox 2）依靠内部操作系统的定时器，这意味着每次调用 <code>new Date().getTime()</code> 都是直接从操作系统中获取。很明显，如果内部定时器每 10 或 15毫秒才更新，是的测试结果的准确性大大降低。我们需要解决这个问题。</p>
<p>幸运的是，可以使用 JavaScript 来<a href="http://mathiasbynens.be/demo/javascript-timers" target="_blank" rel="external">获得最小测量单位</a>，然后，通过一个<a href="http://spiff.rit.edu/classes/phys273/uncert/uncert.html" target="_blank" rel="external">数学方法</a>来使我们的测试结果的不确定度减少到 1% 。要做到这一点，我们需要将测量的最小单位除以 2 来得到的不确定度。假如我们正在 Windows XP 上使用 IE6，最小测量单位是 15 毫秒，那么不确定度就是 15ms / 2 = 7.5ms，然后将其除以 0.01（1%），这样就得到了我们所需的最小测试时间是：7.5ms / 0.01 = 750ms。</p>
<h3><span id="替代计时器">替代计时器</span></h3><p>当使用 <code>--enable-benchmarking</code> 标志来启动 Chrome 时，Chrome 将暴露 <code>chrome.Interval</code> 方法，这个可以用作一个高精度微秒计时器。</p>
<p>回到我们的 Benchmark.js，John-David Dalton 偶然发现了 <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#nanoTime" target="_blank" rel="external">Java 中的纳秒计时器</a>，并通过一个<a href="https://github.com/mathiasbynens/benchmark.js/blob/master/nano.java#files" target="_blank" rel="external">微小的 Java 应用</a>提供给 JavaScript 使用。</p>
<p>使用高精度计时器可以将测试时间分类，它允许更大的样本大小，减小了结果的误差幅度。</p>
<h3><span id="firebug-会禁用-firefox-的-jit">Firebug 会禁用 Firefox 的 JIT</span></h3><p>开启 Firebug 插件会禁用 Firefox 所有的高性能实时（JIT）本地代码编译功能，这意味着你会在解释器运行这些测试，也就是说，您的测试将运行得非常缓慢。你应该永远记住，在 Firefox 下进行基准测试时要禁用 Firebug 插件。</p>
<p>虽然这个影响似乎要小得多，这同样也适用于有 inspector 工具的其他浏览器，比如 WebKit 的 Web Inspector 或 Opera 的 Dragonfly。在进行基准测试时避免这些打开这些工具，因为它可能会影响结果。</p>
<h3><span id="浏览器-bug-和特性">浏览器 bug 和特性</span></h3><p>基准测试中某些形式的循环机制容易受到浏览器一些怪癖的影响，比如最近 IE9 的 <a href="http://www.zdnet.com/blog/bott/ie9-takes-top-benchmark-prize-no-cheating-involved/2671" target="_blank" rel="external">dead-code-removal</a> 的演示，Mozilla 浏览器的 <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=509069" target="_blank" rel="external">TraceMonkey engine bug</a>，还有 Opera 的 <a href="http://jsperf.com/jquery-css3-not-vs-not" target="_blank" rel="external">caching of qSA results</a> 也将导致基准测试结果的不准确。当创建基准测试时，记住这些非常重要。</p>
<h3><span id="统计学意义">统计学意义</span></h3><p>大多数基准测试产生的结果没都有统计学意义，John Resig 在他的文章（<a href="http://ejohn.org/blog/javascript-benchmark-quality/" target="_blank" rel="external">JavaScript benchmark quality</a>）中讨论过这个问题。总之，有必要考虑每个结果的误差幅度，并尽可能减少。使用更大的样本量，并沉着等待测试完成，有助于减少误差幅度。</p>
<h3><span id="跨浏览器测试">跨浏览器测试</span></h3><p>如果你想在不同的浏览器下运行基准测试并得到可靠的结果，一定要在真正的浏览器环境中进行测试。不要信任 IE 的兼容模式 - 这些都<a href="http://jsperf.com/join-concat#comments" target="_blank" rel="external">不同于实际的浏览器版本</a>。</p>
<p>同时，请注意这一事实，IE（IE8 及其以下）将脚本的最大指令数限制为 500 万，而不是像其他浏览器一样，限制一个脚本的执行时间。在现代的硬件环境下，一个密集型 CPU 可以在半秒内触发这个脚本，如果你有一个相当快的系统，在 IE 中你可能会遇到“脚本警告”对话框，在这种情况下，最好的解决方案是修改您的 Windows 注册表，增加指令的数量。幸运的是，微软提供了一个简单的方法来做这个，所有你需要做的就是运行一个简单的“修复”向导，更好的是，在 IE9 中删除了这个愚蠢的限制。</p>
<h2><span id="结论">结论</span></h2><p>不管您只是运行一些基准测试，还是编写自己的测试套件，甚至是编写您自己的基准测试库，都比您在本文中看到的要复杂得多。Benchmark.js 和 jsPerf <a href="https://github.com/mathiasbynens/benchmark.js/commits/master" target="_blank" rel="external">每周更新一次</a>，伴随着 bug 的修复、新的特性和一些提高测试结果的准确性的小技巧。如果您只想在当前流行的浏览器下做一些基准测试，那就不要重复造轮子。。。</p></section><footer class="article-footer clearfix"><div class="tags"><a href="/tags/performance/" title="Performance">Performance</a></div></footer></div><nav class="article-nav clearfix"><a href="/2014/02/19/javascript-profiling-chrome-developer-tools/" class="article-nav-link article-nav-newer"><strong class="article-nav-type">Newer</strong><span class="article-nav-title">使用 Developer Tools 进行 JavaScript 性能分析</span></a><a href="/2014/02/13/writing-fast-memory-efficient-javascript/" class="article-nav-link article-nav-older"><strong class="article-nav-type">Older</strong><span class="article-nav-title">【译】编写快速、高效的 JavaScript</span></a></nav></article><section id="article-comment" class="article-comment"></section><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><style>.gitment-root-container{
  margin: 40px 0;
}
.gitment-container {
  font-size: 12px;
}
.gitment-comment-main, .gitment-editor-main{
  background-color: #fff;
}
.gitment-footer-container{
  color: #999;
}
.gitment-comment-main,
.gitment-editor-main{
  background: #fff;
}
a.gitment-footer-project-link,
a.gitment-footer-project-link:visited,
a.gitment-editor-login-link,
a.gitment-editor-login-link:visited {
  color: #1ba1e2;
  opacity: .3;
  -webkit-transition: opacity 0.4s;
  -moz-transition: opacity 0.4s;
  -o-transition: opacity 0.4s;
  -ms-transition: opacity 0.4s;
  transition: opacity 0.4s;
}
a.gitment-footer-project-link:hover,
a.gitment-editor-login-link:hover{
  opacity: 1;
  -webkit-transition: opacity 0.4s;
  -moz-transition: opacity 0.4s;
  -o-transition: opacity 0.4s;
  -ms-transition: opacity 0.4s;
  transition: opacity 0.4s;
}</style><script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script><script>var options = {
  owner: 'bubkoo',
  repo:  'bubkoo.github.com',
  oauth: {
    client_id: '13c9fa4a27f96e5296bf',
    client_secret: 'd0f07fcf8605a22de1e57fd96ddb0666d2ce0751',
  }
};
var gitment = new Gitment(options);
gitment.render('article-comment')</script></div><aside id="sidebar" role="sidebar"><div class="widget tagcloud"><h3 class="widget-title">标签</h3><div class="widget-content"><a href="/tags/aop/" style="font-size: 10px">AOP</a> <a href="/tags/algorithm/" style="font-size: 18.33px">Algorithm</a> <a href="/tags/analysis/" style="font-size: 10px">Analysis</a> <a href="/tags/angularjs/" style="font-size: 15px">AngularJS</a> <a href="/tags/animation/" style="font-size: 10px">Animation</a> <a href="/tags/architecture/" style="font-size: 16.67px">Architecture</a> <a href="/tags/archives/" style="font-size: 10.83px">Archives</a> <a href="/tags/async/" style="font-size: 12.5px">Async</a> <a href="/tags/backbone/" style="font-size: 10px">Backbone</a> <a href="/tags/browsers/" style="font-size: 10px">Browsers</a> <a href="/tags/css/" style="font-size: 12.5px">CSS</a> <a href="/tags/css3/" style="font-size: 10px">CSS3</a> <a href="/tags/closure/" style="font-size: 10.83px">Closure</a> <a href="/tags/closures/" style="font-size: 10px">Closures</a> <a href="/tags/cookies/" style="font-size: 10px">Cookies</a> <a href="/tags/cross-domain/" style="font-size: 10px">Cross Domain</a> <a href="/tags/custom-elements/" style="font-size: 10.83px">Custom Elements</a> <a href="/tags/d3/" style="font-size: 10px">D3</a> <a href="/tags/debounce/" style="font-size: 10px">Debounce</a> <a href="/tags/debug/" style="font-size: 10.83px">Debug</a> <a href="/tags/dependency/" style="font-size: 10px">Dependency</a> <a href="/tags/document/" style="font-size: 10px">Document</a> <a href="/tags/ecma-262-3/" style="font-size: 15.83px">ECMA-262-3</a> <a href="/tags/ecmascript/" style="font-size: 15.83px">ECMAScript</a> <a href="/tags/es6/" style="font-size: 20px">ES6</a> <a href="/tags/errors/" style="font-size: 10px">Errors</a> <a href="/tags/essential/" style="font-size: 10px">Essential</a> <a href="/tags/evaluation-strategy/" style="font-size: 10px">Evaluation strategy</a> <a href="/tags/event/" style="font-size: 10px">Event</a> <a href="/tags/exceptions/" style="font-size: 10px">Exceptions</a> <a href="/tags/express/" style="font-size: 10px">Express</a> <a href="/tags/flip/" style="font-size: 10px">FLIP</a> <a href="/tags/flexbox/" style="font-size: 10px">Flexbox</a> <a href="/tags/framework/" style="font-size: 10px">Framework</a> <a href="/tags/funarg/" style="font-size: 10px">Funarg</a> <a href="/tags/gist/" style="font-size: 10px">Gist</a> <a href="/tags/github/" style="font-size: 10px">Github</a> <a href="/tags/guide/" style="font-size: 10px">Guide</a> <a href="/tags/html/" style="font-size: 10px">HTML</a> <a href="/tags/http/" style="font-size: 10px">HTTP</a> <a href="/tags/hexo/" style="font-size: 10.83px">Hexo</a> <a href="/tags/ie/" style="font-size: 10px">IE</a> <a href="/tags/iife/" style="font-size: 10px">IIFE</a> <a href="/tags/jshint/" style="font-size: 10px">JSHint</a> <a href="/tags/javascript/" style="font-size: 19.17px">JavaScript</a> <a href="/tags/leak/" style="font-size: 10px">Leak</a> <a href="/tags/linting/" style="font-size: 10px">Linting</a> <a href="/tags/mvc/" style="font-size: 10px">MVC</a> <a href="/tags/methodology/" style="font-size: 10px">Methodology</a> <a href="/tags/mickey/" style="font-size: 10px">Mickey</a> <a href="/tags/mock/" style="font-size: 10px">Mock</a> <a href="/tags/modular/" style="font-size: 10px">Modular</a> <a href="/tags/mongodb/" style="font-size: 10px">MongoDB</a> <a href="/tags/oop/" style="font-size: 10.83px">OOP</a> <a href="/tags/partial-application/" style="font-size: 10px">Partial Application</a> <a href="/tags/pattern/" style="font-size: 10px">Pattern</a> <a href="/tags/patterns/" style="font-size: 10px">Patterns</a> <a href="/tags/performance/" style="font-size: 14.17px">Performance</a> <a href="/tags/promise/" style="font-size: 13.33px">Promise</a> <a href="/tags/prototype/" style="font-size: 11.67px">Prototype</a> <a href="/tags/quality/" style="font-size: 10px">Quality</a> <a href="/tags/quiz/" style="font-size: 10px">Quiz</a> <a href="/tags/react/" style="font-size: 10px">React</a> <a href="/tags/regex/" style="font-size: 10px">Regex</a> <a href="/tags/requirejs/" style="font-size: 10px">RequireJS</a> <a href="/tags/sass/" style="font-size: 10px">SASS</a> <a href="/tags/svg/" style="font-size: 10px">SVG</a> <a href="/tags/scope/" style="font-size: 10.83px">Scope</a> <a href="/tags/shapes/" style="font-size: 10px">Shapes</a> <a href="/tags/shuffle/" style="font-size: 10px">Shuffle</a> <a href="/tags/sort/" style="font-size: 17.5px">Sort</a> <a href="/tags/source-map/" style="font-size: 10.83px">Source Map</a> <a href="/tags/styling/" style="font-size: 10px">Styling</a> <a href="/tags/sublime-text/" style="font-size: 10px">Sublime Text</a> <a href="/tags/template/" style="font-size: 10px">Template</a> <a href="/tags/throttle/" style="font-size: 10px">Throttle</a> <a href="/tags/timing/" style="font-size: 10px">Timing</a> <a href="/tags/tools/" style="font-size: 12.5px">Tools</a> <a href="/tags/variable-object/" style="font-size: 10px">Variable object</a> <a href="/tags/visualizations/" style="font-size: 10px">Visualizations</a> <a href="/tags/when/" style="font-size: 12.5px">When</a> <a href="/tags/delete/" style="font-size: 10px">delete</a> <a href="/tags/execution-context/" style="font-size: 10px">execution context</a> <a href="/tags/fetch/" style="font-size: 10px">fetch</a> <a href="/tags/function/" style="font-size: 10px">function</a> <a href="/tags/nodejs/" style="font-size: 10px">nodejs</a> <a href="/tags/nodemon/" style="font-size: 10px">nodemon</a> <a href="/tags/npm/" style="font-size: 10px">npm</a> <a href="/tags/nvm/" style="font-size: 10px">nvm</a> <a href="/tags/performance/" style="font-size: 10px">performance</a> <a href="/tags/prebrowsing/" style="font-size: 10px">prebrowsing</a> <a href="/tags/prefetching/" style="font-size: 10px">prefetching</a> <a href="/tags/preloading/" style="font-size: 10px">preloading</a> <a href="/tags/tabindex/" style="font-size: 10px">tabindex</a> <a href="/tags/this/" style="font-size: 10px">this</a> <a href="/tags/ui-router/" style="font-size: 14.17px">ui-router</a></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-content"><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/09/21/react-framework-mickey/">React 框架新轮子：Mickey</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/debouncing-throttling-explained-examples/">实例解析防抖和节流函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/08/quick-tip-multiple-versions-node-nvm/">使用 nvm 管理不同版本的 node 与 npm</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/15-ways-to-write-self-documenting-javascript/">如何编写更加自解释的代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/31/high-performance-animations/">使用 FLIP 来提高 Web 动画的性能</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/28/styling-broken-images/">定制图片加载失败时的样式</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/26/delivering-octicons-with-svg/">使用 SVG 输出 Octicon</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/how-to-use-npm-as-a-build-tool/">如何将 npm 作为构建工具使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/24/what-you-can-do-with-gists-on-github/">任何人都可以使用到的 Gist 服务</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/prefetching-preloading-prebrowsing/">前端性能优化 - 资源预加载</a></li></ul></div></div></aside><aside id="topic-wrap" class="toc-wrap f-right"><h3 class="toc-wrap-title">内容</h3><div class="toc-tree"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">基准测试的方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">方式 A</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">方式 A 的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.</span> <span class="toc-text">方式 B</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.</span> <span class="toc-text">方式 B 的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.</span> <span class="toc-text">方式 C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.</span> <span class="toc-text">方式 C 的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.7.</span> <span class="toc-text">方式 D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.</span> <span class="toc-text">方式 D 的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.</span> <span class="toc-text">提取函数体</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">需要考虑的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.1.</span> <span class="toc-text">不准确的毫秒计时器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.2.</span> <span class="toc-text">替代计时器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.3.</span> <span class="toc-text">Firebug 会禁用 Firefox 的 JIT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.4.</span> <span class="toc-text">浏览器 bug 和特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.5.</span> <span class="toc-text">统计学意义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.6.</span> <span class="toc-text">跨浏览器测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">结论</span></a></li></ol></div><div class="toc-progress"></div></aside></div><footer id="footer" class="inner"><span class="copyright">© 2017 bubkoo</span><span class="theme">@<a href="https://github.com/bubkoo/hexo-theme-formula" target="_blank">formula</a></span></footer><img id="go2top" src="/images/top_arrow.png" alt="go2top"><script charset="utf-8" src="/js/lib/jquery-2.1.3.min.js"></script><script charset="utf-8" src="/js/lib/jquery.imagesloaded.min.js"></script><script charset="utf-8" src="/fancybox/jquery.fancybox.pack.js"></script><script charset="utf-8" src="/js/lib/sea.js"></script><script charset="utf-8" src="/js/main.js"></script></body></html>